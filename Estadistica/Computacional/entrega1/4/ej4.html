
<!DOCTYPE html>
<html>
   <head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
      <!-- basic -->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- mobile metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1">
      <!-- site metas -->
      <title>Ejercicio 4</title>
      <meta name="keywords" content="">
      <meta name="description" content="">
      <meta name="author" content="">
      <!-- bootstrap css -->
      <link rel="stylesheet" href="../css/bootstrap.min.css">
      <!-- style css -->
      <link rel="stylesheet" href="../css/style.css">
   </head>
   <!-- body -->
   <body class="main-layout">
      <!-- loader  -->
      <div class="loader_bg">
         <div class="loader"><img src="../images/loading.gif" alt="#" /></div>
      </div>
      <!-- end loader -->
      <!-- header -->
      <header>
         <!-- header inner -->
         <div class="header">
            <div class="container">
               <div class="row">
               </div>
            </div>
         </div>
      </header>
      <!-- end header inner -->
      <!-- end header -->
      <!-- banner -->
      <section class="banner_main">
         <div class="container">
            <div class="row d_flex">
               <div class="col-md-6">
                  <div class="text-bg">
                     <h1>Ejercicio 4</h1>
                     <span>Entrega 1</span>
                     <p><strong>David Cabezas Berrido</strong></p>
                  </div>
               </div>
               <div class="col-md-6">
                  <div class="text-img">
                     <figure><img src="../images/yo.jpg" /></figure>
                  </div>
               </div>
            </div>
         </div>
      </section>
      <!-- end banner -->
      <!-- Contenido -->
      <div id="" class="hosting">
         <div class="container">
            <div class="row">
               <div class="col-md-12">
                  <div class="web_hosting">
                     <p>
Fijamos la semilla.
</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">18</span><span class="hl std">)</span>
</pre></div>
</div></div>

  <p>La urna contiene 5 bolas rojas (R), 8 blancas (B) y 3 negras(N)</p>

<p>En los sucesos a y b entiendo sacar exactamente esas bolas, no más.</p>

<p>Extracción sin reemplazamiento de 5 bolas.</p>
<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">extract5</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(){</span>
  <span class="hl kwd">return</span><span class="hl std">(</span> <span class="hl kwd">sample</span><span class="hl std">(</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl str">'R'</span><span class="hl std">,</span><span class="hl num">5</span><span class="hl std">),</span><span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl str">'B'</span><span class="hl std">,</span><span class="hl num">8</span><span class="hl std">),</span><span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl str">'N'</span><span class="hl std">,</span><span class="hl num">3</span><span class="hl std">)),</span> <span class="hl num">5</span><span class="hl std">, F) )</span>
<span class="hl std">}</span>
</pre></div>
</div></div>

<p>Extracción con reemplazamiento de 5 bolas.</p>
<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">extract5Reemp</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(){</span>
  <span class="hl kwd">return</span><span class="hl std">(</span> <span class="hl kwd">sample</span><span class="hl std">(</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'R'</span><span class="hl std">,</span><span class="hl str">'B'</span><span class="hl std">,</span><span class="hl str">'N'</span><span class="hl std">),</span> <span class="hl num">5</span><span class="hl std">, T,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">5</span><span class="hl std">,</span> <span class="hl num">8</span><span class="hl std">,</span> <span class="hl num">3</span><span class="hl std">)) )</span>
<span class="hl std">}</span>

<span class="hl kwd">extract5</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;B&quot; &quot;R&quot; &quot;B&quot; &quot;R&quot; &quot;B&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">extract5Reemp</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;R&quot; &quot;B&quot; &quot;B&quot; &quot;R&quot; &quot;R&quot;
</pre></div>
</div></div>

<p>Programaremos una función que compruebe si ocurre un suceso en una extracción.</p>
<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">sucesos</span><span class="hl kwb">&lt;-</span><span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">extracciones</span><span class="hl std">){</span>
  <span class="hl std">blancas</span><span class="hl kwb">=</span><span class="hl kwd">sum</span><span class="hl std">(extracciones</span><span class="hl opt">==</span><span class="hl str">'B'</span><span class="hl std">)</span>
  <span class="hl std">rojas</span><span class="hl kwb">=</span><span class="hl kwd">sum</span><span class="hl std">(extracciones</span><span class="hl opt">==</span><span class="hl str">'R'</span><span class="hl std">)</span>
  <span class="hl std">negras</span><span class="hl kwb">=</span><span class="hl kwd">sum</span><span class="hl std">(extracciones</span><span class="hl opt">==</span><span class="hl str">'N'</span><span class="hl std">)</span>
  <span class="hl kwd">return</span><span class="hl std">(</span> <span class="hl kwd">list</span><span class="hl std">(</span> <span class="hl kwc">dosBlancas</span><span class="hl std">=(blancas</span><span class="hl opt">==</span><span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">dosBlancas1roja</span><span class="hl std">=(blancas</span><span class="hl opt">==</span><span class="hl num">2</span> <span class="hl opt">&amp;&amp;</span> <span class="hl std">rojas</span><span class="hl opt">==</span><span class="hl num">1</span><span class="hl std">),</span>
                <span class="hl kwc">dosNegrasAlMenos</span><span class="hl std">=(negras</span><span class="hl opt">&gt;=</span><span class="hl num">2</span><span class="hl std">) ) )</span>
<span class="hl std">}</span>

<span class="hl std">x</span><span class="hl kwb">=</span><span class="hl kwd">extract5</span><span class="hl std">()</span>
<span class="hl std">x</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;N&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;R&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">sucesos</span><span class="hl std">(x)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $dosBlancas
## [1] FALSE
## 
## $dosBlancas1roja
## [1] FALSE
## 
## $dosNegrasAlMenos
## [1] FALSE
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">x</span><span class="hl kwb">=</span><span class="hl kwd">extract5Reemp</span><span class="hl std">()</span>
<span class="hl std">x</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;B&quot; &quot;N&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">sucesos</span><span class="hl std">(x)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $dosBlancas
## [1] FALSE
## 
## $dosBlancas1roja
## [1] FALSE
## 
## $dosNegrasAlMenos
## [1] FALSE
</pre></div>
</div></div>

<h4>Con reemplazamiento</h4>

<p>
 La probabilidad de sacar una bola blanca en una extraccion es de 8/(8+5+3)=1/2.<br/>
 Al ser con reemplazamiento, esta probabilidad no cambia entre extracciones,<br/>
 luego nos encontramos ante una binomial con N=5 y p=0.5,<br/>
 la probabilidad de obtener el valor 2 es 0.3125=5C2*0.5^2*0.5^3.
 </p>

<p>
 La probabilidad de obtener 2 blancas y una roja se obtiene por la fórmula que
 relaciona la probabilidad condicionada con la intersección. <br/>
 P(2 blancas y 1 roja) = P(2 blancas)*P(1 roja / 2 blancas).<br/>
 Falta calcular la probabilidad de obtener una bola roja condicionada a que salen
 dos blancas.<br/>
 Suponiendo que salen dos blancas, en las otras tres bolas solo pueden salir negras y rojas.
 Como hay 5 rojas y 3 negras, y es con reemplazamiento, la probabilidad de sacar
 roja en cada una de las 3 extracciones es 5/(5+3)=5/8=0.625. Por tanto, estamos 
 en una binomial con N=3, p=0.625, y la probabilidad de obtener el valor 1 es <br/>
 3C1*0.625^1*(1-0.625)^2=0.263672. Multiplicando esa probabilidad por la de obtener
 dos bolas blancas, concluimos que la probabilidad de sacar dos blancas y una roja
 es de 0.0823975 (redondeando).
 </p>

<p>
 La probabilidad de sacar bola negra no cambia entre extracciones, así que estamos
 en una binomial N=5, p=3/16=0.1875. La probabilidad de obtener 2 o más es 1 menos
 la de obtener 1 ó 0:
</p>
<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl num">1</span><span class="hl opt">-</span><span class="hl num">5</span><span class="hl opt">*</span><span class="hl num">0.1875</span><span class="hl opt">*</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">-</span><span class="hl num">0.1875</span><span class="hl std">)</span><span class="hl opt">^</span><span class="hl num">4</span><span class="hl opt">-</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">-</span><span class="hl num">0.1875</span><span class="hl std">)</span><span class="hl opt">^</span><span class="hl num">5</span> <span class="hl com"># 0.237339</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.237339
</pre></div>
</div></div>

<p>Ahora realizamos la simulación.</p>
<div class="chunk" id="unnamed-chunk-6"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">repeticiones</span><span class="hl kwb">=</span><span class="hl num">15000</span>

<span class="hl std">dosBlancas</span><span class="hl kwb">=</span><span class="hl num">0</span>
<span class="hl std">dosBlancas1roja</span><span class="hl kwb">=</span><span class="hl num">0</span>
<span class="hl std">dosNegrasAlMenos</span><span class="hl kwb">=</span><span class="hl num">0</span>
<span class="hl kwa">for</span> <span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl std">repeticiones){</span>
  <span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">extract5Reemp</span><span class="hl std">()</span>
  <span class="hl std">res</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sucesos</span><span class="hl std">(x)</span>
  <span class="hl std">dosBlancas</span><span class="hl kwb">=</span><span class="hl std">dosBlancas</span><span class="hl opt">+</span><span class="hl std">res</span><span class="hl opt">$</span><span class="hl std">dosBlancas</span>
  <span class="hl std">dosBlancas1roja</span><span class="hl kwb">=</span><span class="hl std">dosBlancas1roja</span><span class="hl opt">+</span><span class="hl std">res</span><span class="hl opt">$</span><span class="hl std">dosBlancas1roja</span>
  <span class="hl std">dosNegrasAlMenos</span><span class="hl kwb">=</span><span class="hl std">dosNegrasAlMenos</span><span class="hl opt">+</span><span class="hl std">res</span><span class="hl opt">$</span><span class="hl std">dosNegrasAlMenos</span>
<span class="hl std">}</span>
</pre></div>
</div></div>

<p>Frecuencias relativas.</p>

<div class="chunk" id="unnamed-chunk-7"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">dosBlancas</span><span class="hl opt">/</span><span class="hl std">repeticiones</span> <span class="hl com"># Prob teórica = 0.3125</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.3112
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">dosBlancas1roja</span><span class="hl opt">/</span><span class="hl std">repeticiones</span> <span class="hl com"># Prob teórica = 0.0823975</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.0852
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">dosNegrasAlMenos</span><span class="hl opt">/</span><span class="hl std">repeticiones</span> <span class="hl com"># Prob teórica = 0.237339</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.2402
</pre></div>
</div></div>

<p>Una vez más, las probabilidades difieren de las frecuencias relativas,
pero son bastante similares.</p>

<h4>Sin reemplazamiento</h4>

<p>
La probabilidad de sacar dos bolas blancas en 5 extracciones sin reemplazamiento en una urna
 con 16 bolas de las cuales 8 son blancas se cualcula usando la función de densidad de una
 hipergeométrica. Los parámetros son N=16, N1=8, n=5. Obtenemos 8C2*8C3/16C5=14/39=0.358974.
</p>

<p>
 La probabilidad de obtener 2 blancas y una roja se obtiene por la fórmula que
 relaciona la probabilidad condicionada con la intersección.<br/>
 P(2 blancas y 1 roja) = P(2 blancas)*P(1 roja / 2 blancas)<br/>
 Falta calcular la probabilidad de obtener una bola roja condicionada a que salen
 dos blancas.<br/>
 Suponiendo que salen exactamente dos blancas, en las otras tres bolas solo pueden salir negras y rojas.
 Como hay 5 rojas y 3 negras, y es sin reemplazamiento, nos encontramos otra vez ante una
 hipergeométrica con N=8, N1=5, n=3; y la probabilidad de obtener una bola roja es
 5C1*3C2/8C3=15/56=0.267857.<br/>
 Por tanto, multiplicando esa probabilidad por la de obtener dos bolas blancas, concluimos
 que la probabilidad de sacar dos blancas y una roja es de 0.0961537 (redondeando).
</p>

<p>
 Para las bolas negras, tenemos una hipergeométrica de N=16, N1=3, n=5. La probabilidad de obtener
 dos o más bolas negras es la de obtener 2 más la de obtener 3 (no hay más opciones, puesto que sólo hay
 3 bolas negras). Por tanto, obtenemos 3C2*13C3/16C5+3C3*13C2/16C5=3/14=0.2142857.
</p>

<p>Ahora realizamos la simulación.</p>
<div class="chunk" id="unnamed-chunk-8"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">repeticiones</span><span class="hl kwb">=</span><span class="hl num">15000</span>

<span class="hl std">dosBlancas</span><span class="hl kwb">=</span><span class="hl num">0</span>
<span class="hl std">dosBlancas1roja</span><span class="hl kwb">=</span><span class="hl num">0</span>
<span class="hl std">dosNegrasAlMenos</span><span class="hl kwb">=</span><span class="hl num">0</span>
<span class="hl kwa">for</span> <span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl std">repeticiones){</span>
  <span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">extract5</span><span class="hl std">()</span>
  <span class="hl std">res</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sucesos</span><span class="hl std">(x)</span>
  <span class="hl std">dosBlancas</span><span class="hl kwb">=</span><span class="hl std">dosBlancas</span><span class="hl opt">+</span><span class="hl std">res</span><span class="hl opt">$</span><span class="hl std">dosBlancas</span>
  <span class="hl std">dosBlancas1roja</span><span class="hl kwb">=</span><span class="hl std">dosBlancas1roja</span><span class="hl opt">+</span><span class="hl std">res</span><span class="hl opt">$</span><span class="hl std">dosBlancas1roja</span>
  <span class="hl std">dosNegrasAlMenos</span><span class="hl kwb">=</span><span class="hl std">dosNegrasAlMenos</span><span class="hl opt">+</span><span class="hl std">res</span><span class="hl opt">$</span><span class="hl std">dosNegrasAlMenos</span>
<span class="hl std">}</span>

<span class="hl kwd">extract5</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;B&quot; &quot;R&quot; &quot;R&quot; &quot;B&quot; &quot;B&quot;
</pre></div>
</div></div>

<p>Frecuencias relativas.</p>

<div class="chunk" id="unnamed-chunk-9"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">dosBlancas</span><span class="hl opt">/</span><span class="hl std">repeticiones</span> <span class="hl com"># Prob teórica = 0.358974</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.3613333
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">dosBlancas1roja</span><span class="hl opt">/</span><span class="hl std">repeticiones</span> <span class="hl com"># Prob teórica = 0.0961537</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.0976
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">dosNegrasAlMenos</span><span class="hl opt">/</span><span class="hl std">repeticiones</span> <span class="hl com"># Prob teórica = 0.2142857</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.2154667
</pre></div>
</div></div>

<p>
Como en el resto de ejercicios, las probabilidades difieren de las frecuencias relativas,
pero son bastante similares.</p>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <!-- end Contenido -->
      <!--  footer -->
      <footer>
         <div class="footer">
            <div class="copyright">
               <div class="container">
                  <div class="row">
                     <div class="col-md-12">
                        <p>Plantilla tomada de <a href="https://www.free-css.com/free-css-templates/page266/data-web">https://www.free-css.com/free-css-templates/page266/data-web</a></p>
                        
                        <p>© 2019 All Rights Reserved. <a href="https://html.design/">Free html Templates</a></p>   
                     </div>
                  </div>
               </div>
            </div>
         </div>
    
      </footer>
      <!-- end footer -->
      <!-- Javascript files-->
      <script src="../js/jquery.min.js"></script>
      <script src="../js/custom.js"></script>
   </body>
</html>
